import{u as M,m as _,r as y,s as R,n as z,p as H,q as V,f as O,v as B,x as j,y as v,l as N,z as q,_ as F,o as u,c as m,a as i,A as C,t as $,F as I,B as T,C as D,D as K,E as G,G as U}from"./DiWjLvYX.js";const W=a=>a==="defer"||a===!1;function J(...a){var x;const r=typeof a[a.length-1]=="string"?a.pop():void 0;typeof a[0]!="string"&&a.unshift(r);let[t,d,e={}]=a;if(typeof t!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof d!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const s=M(),g=d,S=()=>_.value,E=()=>s.isHydrating?s.payload.data[t]:s.static.data[t];e.server=e.server??!0,e.default=e.default??S,e.getCachedData=e.getCachedData??E,e.lazy=e.lazy??!1,e.immediate=e.immediate??!0,e.deep=e.deep??_.deep,e.dedupe=e.dedupe??"cancel";const h=e.getCachedData(t,s),w=h!=null;if(!s._asyncData[t]||!e.immediate){(x=s.payload._errors)[t]??(x[t]=_.errorValue);const o=e.deep?y:R;s._asyncData[t]={data:o(w?h:e.default()),pending:y(!w),error:z(s.payload._errors,t),status:y("idle"),_default:e.default}}const n={...s._asyncData[t]};delete n._default,n.refresh=n.execute=(o={})=>{if(s._asyncDataPromises[t]){if(W(o.dedupe??e.dedupe))return s._asyncDataPromises[t];s._asyncDataPromises[t].cancelled=!0}if(o._initial||s.isHydrating&&o._initial!==!1){const l=o._initial?h:e.getCachedData(t,s);if(l!=null)return Promise.resolve(l)}n.pending.value=!0,n.status.value="pending";const f=new Promise((l,c)=>{try{l(g(s))}catch(p){c(p)}}).then(async l=>{if(f.cancelled)return s._asyncDataPromises[t];let c=l;e.transform&&(c=await e.transform(l)),e.pick&&(c=X(c,e.pick)),s.payload.data[t]=c,n.data.value=c,n.error.value=_.errorValue,n.status.value="success"}).catch(l=>{if(f.cancelled)return s._asyncDataPromises[t];n.error.value=j(l),n.data.value=v(e.default()),n.status.value="error"}).finally(()=>{f.cancelled||(n.pending.value=!1,delete s._asyncDataPromises[t])});return s._asyncDataPromises[t]=f,s._asyncDataPromises[t]},n.clear=()=>Q(s,t);const P=()=>n.refresh({_initial:!0}),L=e.server!==!1&&s.payload.serverRendered;{const o=N();if(o&&!o._nuxtOnBeforeMountCbs){o._nuxtOnBeforeMountCbs=[];const c=o._nuxtOnBeforeMountCbs;H(()=>{c.forEach(p=>{p()}),c.splice(0,c.length)}),V(()=>c.splice(0,c.length))}L&&s.isHydrating&&(n.error.value||h!=null)?(n.pending.value=!1,n.status.value=n.error.value?"error":"success"):o&&(s.payload.serverRendered&&s.isHydrating||e.lazy)&&e.immediate?o._nuxtOnBeforeMountCbs.push(P):e.immediate&&P();const f=q();if(e.watch){const c=O(e.watch,()=>n.refresh());f&&B(c)}const l=s.hook("app:data:refresh",async c=>{(!c||c.includes(t))&&await n.refresh()});f&&B(l)}const b=Promise.resolve(s._asyncDataPromises[t]).then(()=>n);return Object.assign(b,n),b}function Q(a,r){r in a.payload.data&&(a.payload.data[r]=void 0),r in a.payload._errors&&(a.payload._errors[r]=_.errorValue),a._asyncData[r]&&(a._asyncData[r].data.value=void 0,a._asyncData[r].error.value=_.errorValue,a._asyncData[r].pending.value=!1,a._asyncData[r].status.value="idle"),r in a._asyncDataPromises&&(a._asyncDataPromises[r]&&(a._asyncDataPromises[r].cancelled=!0),a._asyncDataPromises[r]=void 0)}function X(a,r){const t={};for(const d of r)t[d]=a[d];return t}const Y={},Z={class:"d-flex justify-content-center my-5"};function k(a,r){return u(),m("div",Z,r[0]||(r[0]=[i("div",{class:"spinner-grow",style:{width:"3rem","margin-right":".5rem",height:"3rem"},role:"status"},[i("span",{class:"visually-hidden"},"Loading...")],-1),i("div",{class:"spinner-grow",style:{width:"3rem","margin-right":".5rem",height:"3rem"},role:"status"},[i("span",{class:"visually-hidden"},"Loading...")],-1),i("div",{class:"spinner-grow",style:{width:"3rem",height:"3rem"},role:"status"},[i("span",{class:"visually-hidden"},"Loading...")],-1)]))}const A=F(Y,[["render",k]]),ee={class:"col"},ae={class:"card h-100"},te=["src","alt"],se={class:"card-body"},re={class:"card-title"},ne={class:"card-text"},ce=C({__name:"CartItem",props:{car:{type:Object,required:!0}},setup(a){return(r,t)=>(u(),m("div",ee,[i("div",ae,[i("img",{src:a.car.image,class:"card-img-top",alt:`${a.car.brand_name} ${a.car.model_name}`,loading:"lazy"},null,8,te),i("div",se,[i("h5",re,$(a.car.name),1),i("p",ne,"Объем двигателя: "+$(a.car.engine),1)])])]))}}),oe={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},ie=C({__name:"CartList",props:{cars:{type:Array,required:!0}},setup(a){return(r,t)=>{const d=ce;return u(),m("div",oe,[(u(!0),m(I,null,T(a.cars,e=>(u(),D(d,{key:e.id,car:e},null,8,["car"]))),128))])}}}),le=K("cars",()=>{const a=G(),{data:r,refresh:t,status:d}=J(()=>$fetch(a.public.api),{immediate:!1},"$5xRWoEDgHN");return{cars:r,getCars:t,status:d}}),de={class:"container py-5"},fe=C({__name:"index",setup(a){const r=le(),t=y(!0);return U(()=>{r.getCars()}),O(()=>r.status,()=>{r.status==="success"&&(t.value=!1)}),(d,e)=>{const s=A,g=ie;return u(),m("main",null,[i("div",de,[e[0]||(e[0]=i("h1",{class:"text-center mb-5 visually-hidden"},"Автомобилка",-1)),v(t)?(u(),D(s,{key:0})):(u(),D(g,{key:1,cars:v(r).cars},null,8,["cars"]))])])}}});export{fe as default};
